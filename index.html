<!doctype html>
<html lang="el">
<head>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
  <!-- Required for iOS -->
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>sweetmas</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; }

    :root {
      color-scheme: light dark;
      --bg: #fafafa;
      --fg: #111;
      --card-bg: #ffffff;
      --muted: #666;
      --btn-bg: #eee;
      --gap: 1rem;
      --max-width: 400px;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #111;
        --fg: #eee;
        --card-bg: #1c1c1c;
        --muted: #aaa;
        --btn-bg: #2a2a2a;
      }
    }

    body{ margin:0; font-family:system-ui; padding:var(--gap); background:var(--bg); color:var(--fg); display:flex; justify-content:center; min-height:100vh; }

    .main-container { display:flex; flex-direction:column; gap: var(--gap); flex:1; width:100%; max-width: var(--max-width); }

    .card{ background:var(--card-bg); padding:var(--gap); border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.08); text-align:center; display:flex; flex-direction:column; align-items:center; gap: var(--gap); width:100%; }

    .title-container { display:flex; flex-direction:column; align-items:center; font-size:2rem; font-weight:bold; gap:0.1em; padding:.5rem; }
    .title-container span:nth-child(odd){ color:#ff4d4d; }
    .title-container span:nth-child(even){ color:#4dff88; }

    .top-bar{ display:flex; justify-content:space-between; align-items:center; gap: var(--gap); }
    .name{font-size:1.1rem;font-weight:600;color:var(--fg); margin-bottom:0;}

    .counter-row { display:flex; justify-content:space-between; align-items:center; width:100%; gap:1rem; }
    .counter-button { flex:1; font-weight:bold; font-size:1.5rem; height:60%; }
    .counter-center { flex:1; display:flex; flex-direction:column; align-items:center; gap:.5rem; }
    .counter-image { width:5rem; height:5rem; border-radius:10px; background:#ccc; display:flex; justify-content:center; align-items:center; overflow:hidden; }
    .counter-image img { width:100%; height:100%; object-fit:cover; }

    .counter-count { font-size:1.4rem; font-weight:700; color:var(--fg); width:6ch; text-align:center; border:none; background:transparent; -moz-appearance:textfield; }
    .counter-count::-webkit-inner-spin-button, .counter-count::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    .counter-count:focus { outline:2px solid #888; border-radius:4px; }

    button{ border:0; padding:0.5rem 0.75rem; border-radius:8px; font-size:1.2rem; cursor:pointer; background:var(--btn-bg); color:var(--fg); }
    button:active{transform:scale(.97)}

    .footer{ display:flex; flex-wrap:wrap; gap: var(--gap); justify-content:center; }
    .footer button, .footer label{ font-size:0.85rem; padding:0.5rem 0.75rem; background:var(--btn-bg); color:var(--fg); border-radius:8px; cursor:pointer; margin:0; }

    .lang-toggle { padding:0.5rem 0.75rem; border-radius:8px; background:var(--btn-bg); cursor:pointer; font-weight:600; text-align:center; }
    .storage-note { font-size:0.8rem; color:var(--muted); text-align:center; margin-top: auto; }
  </style>
</head>
<body>

<div class="main-container">
  <div class="card title-container">
    <div style="display:flex; gap:0.1em;">
      <span>S</span><span>W</span><span>E</span><span>E</span><span>T</span><span>M</span><span>A</span><span>S</span>
    </div>
  </div>

  <div class="top-bar">
    <div class="card total-container" style="align-items:flex-start;">
      <div class="name" id="total-display">Σύνολο: 0</div>
    </div>
    <div class="lang-toggle" id="lang-toggle">EN</div>
  </div>

  <div id="counters-column" style="display:flex; flex-direction:column; gap: var(--gap);">
    <div class="card">
      <div class="name" data-gr="Μελομακάρονα" data-en="Melomakarona">Μελομακάρονα</div>
      <div class="counter-row">
        <button class="counter-button" data-action="dec" data-key="melomakarona">−</button>
        <div class="counter-center">
          <div class="counter-image"><img src="https://elpidaslittlecorner.gr/wp-content/uploads/2019/12/2h-1100x1536.jpg" alt="Melomakarona"></div>
          <input class="counter-count" id="melomakarona-count" type="number" min="0" inputmode="numeric" pattern="[0-9]*" value="0">
        </div>
        <button class="counter-button" data-action="inc" data-key="melomakarona">+</button>
      </div>
    </div>

    <div class="card">
      <div class="name" data-gr="Κουραμπιέδες" data-en="Kourabiedes">Κουραμπιέδες</div>
      <div class="counter-row">
        <button class="counter-button" data-action="dec" data-key="kourabiedes">−</button>
        <div class="counter-center">
          <div class="counter-image"><img src="https://www.gastronomos.gr/wp-content/uploads/2021/11/kourabiedes-me-indokarydo-gastronomos1-610x762.jpg" alt="Kourabiedes"></div>
          <input class="counter-count" id="kourabiedes-count" type="number" min="0" inputmode="numeric" pattern="[0-9]*" value="0">
        </div>
        <button class="counter-button" data-action="inc" data-key="kourabiedes">+</button>
      </div>
    </div>

    <div class="card">
      <div class="name" data-gr="Δίπλες" data-en="Diples">Δίπλες</div>
      <div class="counter-row">
        <button class="counter-button" data-action="dec" data-key="diples">−</button>
        <div class="counter-center">
          <div class="counter-image"><img src="https://www.tovima.gr/wp-content/uploads/2025/01/02/MadeInGreece_Diples.jpg" alt="Diples"></div>
          <input class="counter-count" id="diples-count" type="number" min="0" inputmode="numeric" pattern="[0-9]*" value="0">
        </div>
        <button class="counter-button" data-action="inc" data-key="diples">+</button>
      </div>
    </div>
  </div>

  <div class="storage-note" id="storage-note">Τα δεδομένα αποθηκεύονται μόνο στη συσκευή σας</div>

  <div class="footer">
    <button id="reset">Clear</button>
    <button id="export-btn">Export</button>
    <label>Import
      <input id="import-file" type="file" accept="application/json" style="display:none" />
    </label>
  </div>
</div>

<script>
(function(){
  const KEYS=['melomakarona','kourabiedes','diples'];
  const STORAGE_KEY='glyka_counts_v1';
  let currentLang='gr';

  const elems={};
  KEYS.forEach(k=>elems[k]=document.getElementById(k+'-count'));
  const totalDisplay=document.getElementById('total-display');
  const langToggle=document.getElementById('lang-toggle');
  const storageNote=document.getElementById('storage-note');

  function readStorage(){
    try{
      const raw=localStorage.getItem(STORAGE_KEY);
      if(!raw) return {counts:{melomakarona:0,kourabiedes:0,diples:0}};
      return JSON.parse(raw);
    }catch(_){return {counts:{melomakarona:0,kourabiedes:0,diples:0}}}
  }

  function writeStorage(state){localStorage.setItem(STORAGE_KEY,JSON.stringify(state))}

  function render(){
    const s=readStorage();
    KEYS.forEach(k=>elems[k].value=s.counts[k]||0);
    const total=KEYS.reduce((a,k)=>a+(s.counts[k]||0),0);
    totalDisplay.textContent=(currentLang==='gr'?'Σύνολο: ':'Total: ')+total;
  }

  function change(key,d){
    const s=readStorage();
    s.counts[key]=Math.max(0,(s.counts[key]||0)+d);
    writeStorage(s);
    render();
  }

  if(!localStorage.getItem(STORAGE_KEY)) writeStorage({counts:{melomakarona:0,kourabiedes:0,diples:0}});
  render();

  document.querySelectorAll('button[data-action]').forEach(b=>{
    b.addEventListener('click',()=>{
      change(b.dataset.key,b.dataset.action==='inc'?1:-1);
    });
  });

  KEYS.forEach(k=>{
    elems[k].addEventListener('change',()=>{
      const val=parseInt(elems[k].value)||0;
      const s=readStorage();
      s.counts[k]=Math.max(0,val);
      writeStorage(s);
      render();
    });
  });

  document.getElementById('reset').onclick=()=>{
    writeStorage({counts:{melomakarona:0,kourabiedes:0,diples:0}});
    render();
  };

  document.getElementById('export-btn').onclick=()=>{
    const blob=new Blob([JSON.stringify(readStorage(),null,2)],{type:'application/json'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a'); a.href=url; a.download='counts.json'; a.click(); URL.revokeObjectURL(url);
  };

  document.getElementById('import-file').onchange=e=>{
    const f=e.target.files[0]; if(!f) return;
    const r=new FileReader();
    r.onload=ev=>{
      try{
        const data=JSON.parse(ev.target.result);
        if(data && data.counts){writeStorage(data);render();}
      }catch(_){alert('Invalid');}
    };
    r.readAsText(f);
  };

  langToggle.addEventListener('click',()=>{
    currentLang = currentLang==='gr'?'en':'gr';
    langToggle.textContent = currentLang==='gr'?'EN':'GR';
    document.querySelectorAll('#counters-column .name, .total-container .name').forEach(el=>{
      el.textContent = currentLang==='gr'?el.dataset.gr:el.dataset.en;
    });
    storageNote.textContent = currentLang==='gr' ? 'Τα δεδομένα αποθηκεύονται μόνο στη συσκευή σας' : 'Data stored on device only';
    render();
    document.getElementById('reset').textContent = currentLang==='gr'?'Μηδενισμός':'Clear';
    document.getElementById('export-btn').textContent = currentLang==='gr'?'Εξαγωγή':'Export';
    document.querySelector('label').firstChild.textContent = currentLang==='gr'?'Εισαγωγή':'Import';
  });
})();
</script>

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>
